
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<!--last modified on Saturday, October 03, 1998 04:19 PM -->
<HTML><!-- #BeginTemplate "/Templates/pink.dwt" --><!-- DW6 -->
<HEAD>
<!-- #BeginEditable "doctitle" -->
<TITLE>Common Syntactic Element</TITLE>
<!-- #EndEditable -->
<meta http-equiv=content-type content="text/html; charset=UTF-8">
<meta name="Author" content="Mark S. Miller">
<link rel=author rev=made title="Mark S. Miller">
<META NAME="description" CONTENT="E: Cryptographic Capabilities for Distributed Smart Contracting">
<META NAME="keywords" CONTENT="p2p, p2p language, p2p computing, p2p objects, secure p2p, p2p capabilities, object oriented p2p,
  capability-based p2p, Capability Security, Capabilities, Cryptography, Distributed Objects, Distributed
  Language, Distributed Capabilities, Lambda Calculus, Scripting Language, Distributed Language, Persistent
  Language, Persistent Capabilities, Persistent Objects, Java Shell, Capability Shell, Scripting Java, Smart
  Contracting, Agoric E-Commerce, Open Source, Message pipelining, quasi literal, vat, event loop, granovetter diagram ">
<link rel="stylesheet" href="../erights.css" type="text/css">
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFEEDD" LINK="#0000FF" VLINK="#800080">
<P>
<TABLE BORDER="0" width="100%">
  <TR VALIGN="TOP">
    <TD WIDTH="10%">&nbsp; </TD>
    <TD> <P>
      <TABLE BORDER="0" WIDTH="100%">
        <TR>
          <TD ALIGN="LEFT" valign="top"> <table cellpadding="2">
              <tr>
                <td valign="top" align="left" colspan="3"><a href="../index.html"><img src="../images/e-lambda.gif" width="32" height="32" border="0" alt="ERights Home"></a>
                  <!-- #BeginEditable "Path" -->/&nbsp;<a href="index.html">data</a>&nbsp;<!-- #EndEditable --></td>
              </tr>
              <tr>
                <td valign="top" align="right"><!-- #BeginEditable "PrevButton" --><a href="overview.html" title="Back to: Overview: Handling Symbolic Data"><img src="../images/prev.gif" width="64" height="32" alt="Back to: Overview: Handling Symbolic Data" border="0"></a><!-- #EndEditable --></td>
                <td valign="bottom" align="left"><!-- #BeginEditable "FirstButton" --><!-- #EndEditable --></td>
                <td valign="top" align="left"><!-- #BeginEditable "NextButton" --><a href="irrelevance.html" title="On to: The Power of Irrelevance"><img src="../images/next.gif" width="64" height="32" alt="On to: The Power of Irrelevance" border="0"></a><!-- #EndEditable --></td>
              </tr>
            </table></TD>
          <TD ALIGN="RIGHT"> <P ALIGN="RIGHT"><FONT SIZE="7"><!-- #BeginEditable "BigTitle" --><B>Common
              Syntactic Element<br>
              <font size="5">For some of the <i><b><font color="#009000">E</font></b></i>
              family of languages</font></B><!-- #EndEditable --></FONT>
          </TD>
        </TR>
      </TABLE>
      <hr> <!-- #BeginEditable "LongBody" -->
      <h1 ALIGN="left"><a name="obligations"></a>Conformance</h1>
      <p ALIGN="left">The <i><font color="#009000"><b>E</b></font></i> system
        defines and supports several source text languages, such as the <i><font color="#009000"><b>E</b></font></i>
        language, Kernel-E, and TermL. This document specifies those aspects of
        syntax that these languages have in common. Since the source texts of
        these languages can be considered a kind of web content (though not a
        kind of markup), texts are written in characters, and characters are no
        longer a trivial matter, we specify that</p>
      <ul>
        <li>[S] This document, and all specifications conforming to this document,
          except where otherwise noted, <a href="../glossary.html#MUST" class="glossary">MUST</a>
          conform to the <a href="http://www.w3.org/TR/charmod/">Character Model
          for the World Wide Web</a>, hereafter &quot;CharMod&quot;. </li>
      </ul>
      <p ALIGN="left">We adopt the notations and conventions from</p>
      <table width="100%"  cellpadding="12">
        <tr>
          <th bgcolor="#FFFFFF">The <a href="http://www.w3.org/TR/charmod/#sec-Conformance">Conformance</a>
            section from CharMod</th>
        </tr>
        <tr>
          <td bgcolor="#FFFFFF"> <blockquote>
              <p align="left">This section explains what conditions specifications,
                software, and Web content have to fulfill to be able to claim
                conformance to this specification.</p>
              <p>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;,
                &quot;SHALL&quot;, &quot;SHALL NOT&quot;, SHOULD&quot;, &quot;SHOULD
                NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot; and &quot;OPTIONAL&quot;
                in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC
                2119</a> [RFC 2119].</p>
              <blockquote>
                <p><b>NOTE</b>: RFC 2119 makes it clear that requirements that
                  use SHOULD are not optional and must be complied with unless
                  there are specific reasons not to: &quot;<i>This word, or the
                  adjective &quot;RECOMMENDED&quot;, mean that there may exist
                  valid reasons in particular circumstances to ignore a particular
                  item, but the full implications must be understood and carefully
                  weighed before choosing a different course.</i>&quot;</p>
              </blockquote>
              <p>This specification defines conformance criteria for specifications,
                for software and for Web content. To aid the reader, all conformance
                criteria are preceded by '[X]' where 'X' is one of 'S' for specifications,
                'I' for software implementations, and 'C' for Web content. These
                markers indicate the relevance of the conformance criteria and
                allow the reader to quickly locate relevant conformance criteria
                by searching through this document.</p>
              <p>A specification conforms to this document if they:</p>
              <ol>
                <li> [do] not violate any conformance criteria preceded by [S],
                <li>documents the reason for any deviation from criteria where
                  the imperative is SHOULD, SHOULD NOT, or RECOMMENDED,
                <li>if applicable, requires implementations conforming to the
                  specification to conform to this document,
                <li>if applicable, requires content conforming to the specification
                  to conform to this document.
              </ol>
              <p>Implementations (software) conform to this document if it does
                not violate any conformance criteria preceded by [I].</p>
              <p>Content conforms to this document if it does not violate any
                conformance criteria preceded by [C].</p>
              <blockquote>
                <p><b>NOTE</b>: Requirements placed on specifications might indirectly
                  cause requirements to be placed on implementations or content
                  that claim to conform to those specifications. Likewise, requirements
                  placed on content may affect implementations designed to produce
                  such content, and so on.</p>
              </blockquote>
              <p>Where this specification places requirements on processing, it
                is to be understood as a way to specify the desired external behavior.
                Implementations can use other means of achieving the same results,
                as long as observable behavior is not affected.</p>
            </blockquote></td>
        </tr>
      </table>
      <p ALIGN="left">[S] This spec MUST only state that content MUST (or MUST
        NOT, SHALL, SHALL NOT, REQUIRED) conform to some criterion when it is
        feasible for a program (an &quot;source validator&quot; -- see below)
        to check whether some input content does indeed conform.</p>
      <p ALIGN="left">[I] A <i>source validator</i> is a program that MUST determine
        whether content conforms to this spec.</p>
      <p ALIGN="left">&nbsp;</p>
      <p ALIGN="left">A language spec places requirements on the (authors of)
        source text written in that language, and on the actions of the canonical
        kind of &quot;language processor&quot;, such as a compiler or interpreter,
        that is to interpret source text written in that language. (A syntax highlighter
        is an example of a non-canonical kind of language processor.) When we
        state that the source text MUST (or MUST NOT, SHALL, SHALL NOT, REQUIRED),
        unless stated otherwise, there is a corresponding requirement on the canonical
        kinds of language processor for that language that they MUST statically
        reject sources that violate that obligation.</p>
      <p ALIGN="left">When we state that the source text SHOULD (or SHOULD NOT,
        RECOMMENDED, NOT RECOMMENDED), unless stated otherwise, we make a corresponding
        recommendation that lint-like tools SHOULD be built, incorporated in development
        environments, and employed during code reviews, so that programmers and
        code reviewers are aware of all violations of these recommendations, or
        of other surprises that may cause them to misread what they are looking
        at. These recommendations should be consistent with those in <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf#G25728">Unicode
        Security</a>.</p>
      <blockquote>
        <h2 ALIGN="left">Rationale</h2>
        <p ALIGN="left">The <i><font color="#009000"><b>E</b></font></i> family
          is intended to support <a href="../elib/capability/index.html">secure
          programming</a> and <a href="irrelevance.html">adversarial code reviews</a>.
          The author of the source text, the reviewers reading it to understand
          what it might do, and the owner of the language processor on which it
          runs may all be mutually suspicious parties with somewhat divergent
          interests. (A programmer using his development environment to decide
          whether to depend on a third party's library is, by our criteria, a
          kind of code reviewer.) The rules below on what source text MUST and
          MUST NOT do are designed to enable these parties to safely cooperate
          by use of these source texts. If source-author Alice has a reasonable
          expectation that a rule violation by Alice might not be caught by code
          reviewer Bob or language processor host Carol, then Alice may choose
          to violate that rule, independent of the wording in specifications such
          as this. To avoid confusion, we only say &quot;MUST&quot;, etc, when
          the rule can be enforced by the canonical language processor.</p>
        <p ALIGN="left">The reverse case is different: If Carol operates her language
          processor in ways that violate these rules, <a href="../elib/capability/ode/ode-protocol.html#subj-aggregate">no
          one is necessarily in a position to catch her</a>. Therefore, the stated
          obligations on her language processor are primarily for her own protection.</p>
      </blockquote>
      <h1 ALIGN="left"><a name="dependencies"></a>Dependencies and Versions</h1>
      <table align="right" cellpadding="12">
        <tr>
          <th colspan="2">Version Dependencies</th>
        </tr>
        <tr>
          <td><p><a href="../elang/grammar/index.html">the <i><font color="#009000"><b>E</b></font></i>
              language</a><br>
              <a href="../elang/kernel/index.html">Kernel-E</a><br>
              <a href="terml/terml-spec.html">TermL</a></p></td>
          <td>0.9 / alpha</td>
        </tr>
        <tr>
          <td>IETF</td>
          <td><p><a href="http://www.ietf.org/rfc/rfc2119.txt">rfc2119</a> <br>
              <a href="http://ftp.ics.uci.edu/pub/ietf/uri/rfc2396.txt">rfc2396</a></p></td>
        </tr>
        <tr>
          <td>W3C</td>
          <td><a href="http://www.w3.org/TR/charmod/">CharMod</a><br> <a href="http://www.w3.org/TR/charmod-norm/">CharNorm</a>
          </td>
        </tr>
        <tr>
          <td>Unicode<br> <a href="http://www.unicode.org/reports/tr15/">NFC</a>,
            <a href="http://www.unicode.org/unicode/reports/tr20/#Suitable">tr20</a><br>
            <a href="http://www.unicode.org/glossary/">glossary</a></td>
          <td><a href="http://www.unicode.org/versions/Unicode4.0.0/">4.0</a><br>
            <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf#G25728">Security</a>
          </td>
        </tr>
        <tr>
          <td>Java</td>
          <td><a href="http://java.sun.com/j2se/1.3/docs/">1.3.1</a></td>
        </tr>
      </table>
      <p ALIGN="left">Some of the <i><font color="#009000"><b>E</b></font></i>
        family of languages -- the <i><font color="#009000"><b>E</b></font></i>
        language, Kernel-E, and TermL -- delegate aspects of their specifications
        to other specifications, such as this page. This page in turn delegates
        to yet other specifications, such as Java, Unicode, and various IETF and
        W3C standards. This page currently intends to support the specifications
        of the <i><font color="#009000"><b>E</b></font></i> family as of the upcoming
        <i><font color="#009000"><b>E</b></font></i> 0.9 release (also to be known
        as <i><font color="#009000"><b>E</b></font></i> alpha). For each <i><font color="#009000"><b>E</b></font></i>
        release, the Version Dependencies table to the right specifies the minimal
        version of these other standards it depends on. An <i><font color="#009000"><b>E</b></font></i>
        program written to run on a given version of <i><font color="#009000"><b>E</b></font></i>
        SHOULD be compatible with the spec of that version as interpreted in terms
        of the minimal versions of the dependent versions of the other standards
        <i>or later</i>. For example, the <i><font color="#009000"><b>E</b></font></i>
        language 0.9 spec depends on Java 1.3.1 or later. Therefore, an <i><font color="#009000"><b>E</b></font></i>
        0.9 program SHOULD be compatible with, for example, the <i><font color="#009000"><b>E</b></font></i>
        0.9 spec interpreted in light of the Java 1.4 spec. Below, we generally
        leave out the version number of dependent specifications, and try to link
        to the latest relevant version of each one. Please consult this Version
        Dependencies table for the actual correspondences.</p>
      <p ALIGN="left">Besides covering <i><font color="#009000"><b>E</b></font></i>
        0.9, we will also explain how we hope to evolve in upcoming <i><font color="#009000"><b>E</b></font></i>
        releases, and discuss the potential compatibility implications.</p>
      <h1 ALIGN="left"><a name="raw_text"></a>From Bytes (Octets) to Unbaked Source
        Text</h1>
      <h2 ALIGN="left"><a name="only_bmp"></a>Only BMP Characters</h2>
      <p ALIGN="left">Unbaked source text consists only of a sequence of Unicode <a href="http://www.unicode.org/glossary/#encoded_character">encoded
        characters</a>. As of <i><font color="#009000"><b>E</b></font></i> 0.9,
        raw source text contains only <a href="http://www.unicode.org/glossary/#BMP_character">BMP
        characters</a>, i.e., only those Unicode <a href="http://www.unicode.org/glossary/#encoded_character">encoded
        characters</a> whose <a href="http://www.unicode.org/glossary/#code_point">code
        points</a> fit within 16 bits. When source text is obtained from a source
        of octets (such as a file), then these octets are to be decoded according
        to<a href="http://www.unicode.org/glossary/#UTF_8"> UTF-8</a> to create
        the sequence of encoded characters. We call this sequence, prior to further
        processing, the &quot;raw source text&quot; consisting of &quot;raw source
        characters&quot;. </p>
      <blockquote>
        <h2 ALIGN="left">Rationale</h2>
        <p ALIGN="left">The <i><font color="#009000"><b>E</b></font></i> 0.9 requirement
          that the raw source text MUST contain only <a href="http://www.unicode.org/glossary/#BMP_character">BMP
          characters</a> implies that it MUST NOT contain any</p>
        <ul>
          <li><a href="http://www.unicode.org/glossary/#supplementary_character">supplementary
            characters</a> -- characters whose code points are larger than 16
            bits, i.e., are in the range 0x1_0000..0x10_FFFF.</li>
          <li><a href="http://www.unicode.org/glossary/#surrogate_code_point">surrogate_code_points</a>
            -- code points in the range 0xD800 through 0xDFFF. The <a href="http://www.unicode.org/glossary/#general_category">general
            category</a> of these is &quot;Cs&quot;.</li>
          <li><a href="http://www.unicode.org/glossary/#undesignated_code_point">undesignated
            code points</a> -- also called reserved or unassigned code points,
            whose interpretation is not yet specified as of Unicode 4.0. The <a href="http://www.unicode.org/glossary/#general_category">general
            category</a> of these is &quot;Cn&quot;.</li>
        </ul>
        <p>A canonical kind of language processor of such source text MUST therefore
          statically reject input containing (or whose UTF-8 decoding would contain)
          code points that are not encodings of BMP characters.</p>
        <blockquote>
          <pre><span class="stdout">? </span><span class="keyword">def</span> <span class="defvar">makeChar</span> := &lt;import:<span class="litchars">java.lang.Character</span>&gt;
<span class="stdout"># value: &lt;import:java.lang.Character&gt;

? </span><span class="keyword">def</span> <span class="defobj">isBMPChar</span>(<span class="defvar">codePoint</span> :(0..0x10_FFFF) :boolean {
<span class="stdout">&gt; </span>    <span class="comment"># If it's not in the range 0..0x10_FFFF, then it's not a valid Unicode code point</span>
<span class="stdout">&gt; </span>
<span class="stdout">&gt; </span>    <span class="keyword">if</span> (codePoint &gt; 0xFFFF) {
<span class="stdout">&gt; </span>        <span class="comment"># If it's larger than 0xFFFF, then it's a supplemental code point, rather than in the BMP</span>
<span class="stdout">&gt; </span>        <span class="keyword">return</span> false
<span class="stdout">&gt; </span>    }
<span class="stdout">&gt; </span>    <span class="comment"># If it's in the BMP, then, even in E 0.9, we can convert it to a char.</span>
<span class="stdout">&gt; </span>    <span class="keyword">def</span> <span class="defvar">ch</span> := codePoint.asChar()
<span class="stdout">&gt; </span>    <span class="keyword">def</span> <span class="defvar">cat</span> := ch.getCategory()
<span class="stdout">&gt; </span>
<span class="stdout">&gt; </span>    <span class="comment"># If it's general category isn't SURROGATE (Cs)  or UNASSIGNED (Cn), does that mean it must be</span>
<span class="stdout">&gt; </span>    <span class="comment"># a Unicode  encoded character?</span>
<span class="stdout">&gt; </span>    <span class="keyword">return</span> typ != &quot;<span class="litchars">Cs</span>&quot; &amp;&amp; typ != &quot;<span class="litchars">Cn</span>&quot;
<span class="stdout">&gt; </span>}
<span class="stdout"># value: &lt;isBMPChar&gt;</span></pre>
        </blockquote>
        <p ALIGN="left">Because we do not yet have any personal experience with
          non-<a href="http://www.unicode.org/glossary/#ASCII">ASCII</a> Unicode
          characters at the time of this writing, we considered specifying that
          raw source text for <i><font color="#009000"><b>E</b></font></i> 0.9
          be restricted to ASCII, and therefore that all non-ASCII source characters
          may only be expressed using Backslash-u Decoding (see below). However,
          this would be too great a burden on non-English-based programmers wishing
          to use <i><font color="#009000"><b>E</b></font></i>. </p>
        <p ALIGN="left">In the other direction, unless we hear otherwise from
          Unicode users, we expect to eventually support the <a href="http://www.unicode.org/glossary/#supplementary_character">supplementary
          characters</a> as well. However, at the time of this writing, it is
          not clear what the preferred means will be for providing such support.
          Two obvious choices:</p>
        <ol>
          <li>Allow raw source text to include <a href="http://www.unicode.org/glossary/#supplementary_character">supplementary
            characters</a>.</li>
          <li>Allow raw source text to include <a href="http://www.unicode.org/glossary/#surrogate_pair">surrogate
            pairs</a> that decode into a supplementary character. (Or does the
            Unicode standard <a href="http://www.eros-os.org/pipermail/e-lang/2004-April/009773.html">forbid</a>
            this choice, given that it would occur after a UTF-8 decode?)</li>
        </ol>
        <p ALIGN="left">It seems that <a href="http://jcp.org/aboutJava/communityprocess/review/jsr204/index.html">Javasoft
          is considering allowing both</a>, which is another possible choice.
          We look forward to feedback from Unicode users to guide us.</p>
        <p ALIGN="left">As future Unicode standards make use of code points which
          are currently reserved, future versions of <i><font color="#009000"><b>E</b></font></i>
          may well accept these characters as well. </p>
        <p ALIGN="left">Our current stances are adequate for our current needs,
          and any of these choices would be upwards compatible from here. Until
          further notice, <i><font color="#009000"><b>E</b></font></i> users should
          be prepared for any of these futures. </p>
      </blockquote>
      <h2><a name="no_controls"></a>No Non-Whitespace Control Characters</h2>
      <p>Unbaked source text MAY contain the whitespace characters: </p>
      <ul>
        <li><tt> ' '</tt> (space), </li>
        <li><tt>'\t'</tt> (tab),</li>
        <li> <tt>'\n'</tt> (linefeed or newline), and </li>
        <li><tt>'\r'</tt> (carriage return)</li>
      </ul>
      <p>but MUST NOT contain other <a href="http://www.unicode.org/glossary/#control_codes">control
        codes</a>. (Characters whose <a href="http://www.unicode.org/glossary/#general_category">general
        category</a> is &quot;Cc&quot;.)
      <blockquote>
        <h2 ALIGN="left">Rationale</h2>
        <p ALIGN="left">Whitespace is invisible, and therefore creates <a href="http://compsoc.dur.ac.uk/whitespace/index.php">opportunities</a>
          for the meaning of source text to be less than apparent from its visual
          appearance. We limit allowed whitespace to contribute towards the <a href="#wysiwyg">wysiwyg
          ideal, explained below</a>.</p>
        <p ALIGN="left">Should we likewise forbit other invisible characters,
          such as characters whose general category is any of the following?</p>
        <ul>
          <li>&quot;Zs&quot;, &quot;Zl&quot;, &quot;Zp&quot; -- the kinds of SEPARATOR
            character</li>
          <li>&quot;Cf&quot; -- FORMAT characters</li>
          <li>&quot;Co&quot; -- PRIVATE_USE characters</li>
        </ul>
        Pending advice from Unicode users, these are tentatively allowed for now.</blockquote>
      <h2><a name="only_nfc"></a>Unbaked Source Text Must be in NFC</h2>
      <p>Unbaked source text MUST be in <a href="http://www.unicode.org/reports/tr15/">Unicode
        Normalized Form C (NFC)</a>, and MUST NOT contain <a href="http://www.unicode.org/unicode/reports/tr20/#Suitable">Characters
        not Suitable for use With Markup</a>.
      <blockquote>
        <h2 ALIGN="left">Rationale</h2>
        <p ALIGN="left">Without normalization, Unicode is far from wysiwyg --
          from the <a href="http://www.unicode.org/glossary/#glyph_image">appearance
          of text</a> on paper or screen, you would have little information about
          what sequence of <a href="http://www.unicode.org/glossary/#encoded_character">encoded
          characters</a> you are looking at. To contribute towards the <a href="#wysiwyg">wysiwyg
          ideal, explained below</a>, it makes sense to require that raw source
          text be in one of the Unicode normalized forms. Given that our source
          languages are case sensitive, NFKC would be too narrow. (It is only
          recommended for case insensitive sources.) NFC seems to be the emerging
          consensus normalization form (see <a href="http://www.w3.org/TR/charmod-norm/">Character
          Model for the World Wide Web</a>), so it seems sensible for us to adopt
          it.</p>
        <p ALIGN="left">Even NFC-normalized Unicode text without <a href="http://www.unicode.org/unicode/reports/tr20/#Suitable">Characters
          not Suitable for use With Markup</a> is still far from wysiwyg. We hope
          Unicode users will give us advice on how we should cope with the remaining
          presentational ambiguities of Unicode. At a minimum, tools SHOULD alert
          reviewers to non-ASCII source text that may easily be mistaken for ASCII
          source text. Should tools additionally alert reviewers if a source text
          is not in NFKC?</p>
      </blockquote>
      <h1 align="left"><a name="normalizing"></a>From Unbaked to Normalized Source
        Text</h1>
      <p ALIGN="left">Once we have raw source text that passes the above checks,
        the following transformations are then applied, logically in order, to
        create the normalized source text, prior to lexical analysis:</p>
      <ol>
        <li>
          <p><b><a name="newlines"></a>Newline Canonicalization.</b> The three
            common encodings of newline -- <tt>&quot;\r\n&quot;</tt>, <tt>&quot;\r&quot;</tt>,
            and <tt>&quot;\n&quot;</tt> -- are all canonicalized to <tt>&quot;\n&quot;</tt>.</p>
        </li>
        <li>
          <p><b><a name="kill_endspaces"></a>Trailing Horizontal Whitespace Truncation.</b>
            Sequences of non-newline <tt>' '</tt> (space) and <tt>'\t'</tt> (tab)
            characters at the end of a line (i.e., immediately preceding a newline
            or at the end of the source text as a whole) are removed. </p>
        </li>
        <li>
          <p><b><a name="kill_endlines"></a>Trailing Newline Truncation.</b> Trailing
            newlines at the end of the source text as a whole are replaced with
            a single newline.</p>
        </li>
        <li>
          <p align="left"><b><a name="numbering"></a>Line and Column Numbering</b>.
            Line and column numbers designate positions in the source text after
            the above steps, and prior to the following steps. The first line
            is line number 1. The first column is column number 0.</p>
        </li>
        <li>
          <p><b><a name="splicing"></a>Line Splicing</b>. A <tt>&quot;\\\n&quot;</tt>
            (a backslash immediately followed by a newline) is removed unless
            it is immediately preceded by a consecutive sequence of an odd number
            of backslashes.</p>
        </li>
        <li>
          <p><b><a name="backslash_u"></a>Backslash-u Decoding.</b> A <tt>&quot;\\u&quot;</tt>
            (backslash followed by <tt>a 'u')</tt> and 4 immediately following
            <a href="#digit16">digit16</a>s (hex digits) is decoded into that
            <a href="http://www.unicode.org/glossary/#code_point">code point</a>.
            Likewise, a <tt>&quot;\\u{&quot;</tt> followed by some <a href="#digit16">digit16</a>s
            and a <tt>&quot;}&quot;</tt> is decoded into that code point. Such
            interpretation is suppressed if this sequence is preceded by a consecutive
            sequence of an odd number of backslashses. As of <i><font color="#009000"><b>E</b></font></i>
            0.9, backslash-u decoding MUST result only in <a href="http://www.unicode.org/glossary/#BMP_code_point">BMP
            code points</a>.</p>
        </li>
      </ol>
      <p ALIGN="left">By &quot;logically in order&quot;, we mean the result must
        be equivalent to what it would be if each stage were applied to the output
        of the previous stage, not including itself. For example, a <tt>&quot;\r\t&nbsp;\r\n&nbsp;\\\n&nbsp;\n&quot;</tt>
        sequence must be transformed into <tt>&quot;\n\n&nbsp;\n&quot;</tt> rather
        than <tt>&quot;\n\n&quot;</tt>.</p>
      <p ALIGN="left">When a source language uses matched brackets to indicate
        nesting structure to a language processor, a source text in this language
        SHOULD use spaces for indentation to signal this nesting structure to
        the human eye. Further, source text SHOULD NOT include any tab characters
        at all. Code reviewers SHOULD be alerted to violations of these recommendations.
        When rendering text in a fixed width font, tab characters SHOULD be rendered
        as whitespace extending to the next modulo-8 tab stop.</p>
      <blockquote>
        <h2 ALIGN="left">Rationale</h2>
        <p ALIGN="left">Line and column positions are robust in the face of Newline
          Canonicalization and Trailing Whitespace Rejection. If such positions
          are interpreted (e.g., by an IDE) on the source text after UTF-8 Decoding
          but prior to these steps, the results will still be sensible.</p>
        <p ALIGN="left">Since ASCII is a subset of UTF-8, Backslash-u Decoding
          allows ASCII source text to represent any sequence of <a href="http://www.unicode.org/glossary/#code_point">code
          points</a>.</p>
        <p ALIGN="left">We introduce the curly-bracketed backslash-u form to prepare
          for eventually allowing longer Unicode characters. but this restriction
          may eventually be lifted separately from lifting the restriction of
          raw source text to <a href="http://www.unicode.org/glossary/#BMP_character">BMP
          characters</a>.</p>
        <p ALIGN="left"> If this would result in a non-BMP code point, i.e., a
          code outside the range 0x0000..0xFFFF, then the source MUST be statically
          rejected.</p>
        <h3 ALIGN="left"><a name="wysiwyg"></a>Making Sources More Wysiwyg </h3>
        <p ALIGN="left">We wish to make sources as wysiwyg as reasonably possible,
          in order to support <a href="irrelevance.html">adversarial code reviews</a>.</p>
        <p ALIGN="left">Trailing Whitespace Truncation can only be significant
          within quoted literal character sequences, and helps ensure that these
          character sequences are wysiwyg -- that their visual depiction is an
          accurate portrayal of their contents.</p>
        <p ALIGN="left">&nbsp;</p>
        <p ALIGN="left">We reject non-NFC-canonical Unicode sequences, rather
          than perform NFC canonicalization, to avoid the danger of silently changing
          the intended meaning of the source text. When such normalization is
          desired, it's easy enough to apply a separate tool to perform such normalization
          as an edit to the source text.</p>
        <p ALIGN="left">Backslash-u Decoding occurs after Non-Canonical Unicode
          Rejection so that a normalized source character sequence may be essentially
          any sequence of Unicode16 characters, but non-canonical sequences can
          only be expressed by the visible use of the backslash-u. </p>
        <p ALIGN="left">These rules by themselves are not sufficient to make sources
          wysiwyg. </p>
        <ul>
          <li>
            <p>The NFC canonicalization rules may leave two different strings
              that appear to be the same to the untrained eye, or depending on
              the choice of font. As such ambiguities are noticed, we recommend
              building lint-like tools to spot these and alerting reviewers. For
              example, we recommend that source text, prior to Backslash-u Decoding,
              SHOULD be in the narrower Unicode Normalized Form KC (NFKC), and
              that reviewers should check whether this is the case prior to conducting
              a review. (However, we only enforce the less strict NFC normalization,
              because NFKC is too severe for case sensitive languages.)</p>
          </li>
          <li>
            <p>The remaining whitespace difference between ' ' (space) and '\t'
              (tab) is not visible. Rather than reject sources that contain harmless
              tabs, we defer this issue to the tokenization rules. The tokenization
              rules MUST reject tabs where they can be semantically significant,
              such as within literal character sequences (i.e., between quote
              marks or within DocComments).</p>
          </li>
        </ul>
      </blockquote>
      <h1 ALIGN="left"><a name="charclasses"></a>Character Classes </h1>
      <table bgcolor='#f5dcb3' cellpadding="12" bordercolor="#FFFFFF">
        <tr valign='top'>
          <th align='left' colspan="2">Name</th>
          <th align='center'>&nbsp;</th>
          <th align='left'>Definition</th>
          <th align='left'>Ascii subset</th>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='hspace'></a></pre></td>
          <td align='right'> <pre>hspace</pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left'> <pre>' ' | '\t'</pre></td>
          <td align='left'> <pre>' ' | '\t'</pre></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='whitespace'></a></pre></td>
          <td align='right'> <pre>whitespace</pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left'> <pre>' ' | '\t' | '\n'</pre></td>
          <td align='left'> <pre>' ' | '\t' | '\n'</pre></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='digit10'></a></pre></td>
          <td align='right'> <pre><font>digit10</font></pre></td>
          <td align='center'> <pre><font>::=</font></pre></td>
          <td align='left'> <pre><a href="http://java.sun.com/j2se/1.3/docs/api/java/lang/Character.html#isDigit(char)">isDigit</a></pre></td>
          <td align='left'> <pre><font>'0'..'9'</font></pre></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='digit8'></a></pre></td>
          <td align='right'> <pre><font>digit8</font></pre></td>
          <td align='center'> <pre><font>::=</font></pre></td>
          <td align='left'>&nbsp;</td>
          <td align='left'> <pre><font>'0'..'7'</font></pre></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='digit16'></a></pre></td>
          <td align='right'> <pre><font>digit16</font></pre></td>
          <td align='center'> <pre><font>::=</font></pre></td>
          <td align='left'>&nbsp;</td>
          <td align='left'> <pre><font>'0'..'9' | 'a'..'f' | 'A'..'F'</font></pre></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='uric'></a></pre></td>
          <td align='right'> <pre><font>uric</font></pre></td>
          <td align='center'> <pre><font>::=</font></pre></td>
          <td align='left'> <pre>  <a href="http://www.ics.uci.edu/pub/ietf/uri/rfc2396.txt">IETF-URICs</a>
| '\\' | '|' | '#'</pre></td>
          <td align='left'> <pre>  'a'..'z' | 'A'..'Z' | '0'..'9'
| anyof(&quot;_$.-;/?:@&amp;=+,!~*'()%\\|#&quot;)</pre></td>
        </tr>
      </table>
      <p><i>The non-ascii cases are not yet tested in the current implementations.</i></p>
      <p>In the <a href="#uric">uric</a> production, each '\\' (backslash) character
        is converted to '/', and each '|' (vertical bar) character is converted
        to ':'. Therefore, the possible semantic values associated with this production
        do not include the backslash or vertical bar characters.</p>
      <h1><a name="tokentypes"></a>Token Types</h1>
      <p>In the following table, the bold names with initial capitals are the
        token types. The others are supporting productions.</p>
      <table border='0' bgcolor='#f5dcb3' cellpadding="12">
        <tr valign='top'>
          <th align='left' colspan="2">Name</th>
          <th align='center'>&nbsp;</th>
          <th align='left'>Definition</th>
          <th align='left'>Denotes</th>
        </tr>
        <tr valign='top'>
          <td align='right'><a name="digit10s"></a></td>
          <td align='right'><pre>digit10s</pre></td>
          <td align='center'> <pre><font> ::= </font></pre></td>
          <td align='left'><pre><a href="#digit10">digit10</a> ('_'? <a href="#digit10">digit10</a>)*</pre></td>
          <td align='left'>&nbsp;</td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='Integer'></a></pre></td>
          <td align='right'> <pre><font><b>Integer</b></font></pre></td>
          <td align='center'> <pre><font> ::= </font></pre></td>
          <td align='left'> <pre>  '-'? '0' 'x' <a href="#digit16">digit16</a> ('_'? <a href="#digit16">digit16</a>)*
| '-'? '0' ('_'? <a href="#digit8">digit8</a>)*  <font class="comment"># not yet implemented</font>
/ '-'? <a href="#digit10s">digit10s</a></pre></td>
          <td align='left'> <p>Precision-unlimited integer.</p></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='wholePart'></a></pre></td>
          <td align='right'> <pre>wholePart</pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left'> <pre>'-'? <a href="#digit10s">digit10s</a></pre></td>
          <td align='left'>&nbsp;</td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='fraction'></a></pre></td>
          <td align='right'> <pre>fraction</pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left'> <pre>'.' <a href="#digit10s">digit10s</a></pre></td>
          <td align='left'>&nbsp;</td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='exponent'></a></pre></td>
          <td align='right'> <pre><font>exponent</font></pre></td>
          <td align='center'> <pre><font> ::= </font></pre></td>
          <td align='left'> <pre><font>('e' | 'E') '-'? <a href="#digit10s">digit10s</a></font></pre></td>
          <td align='left'>&nbsp;</td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='Real64' id="Real64"></a></pre></td>
          <td align='right'> <pre><b>Real64</b></pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left'> <pre>  <a href="#wholePart">wholePart</a> <a href="#fraction">fraction</a> <a href="#exponent">exponent</a>?
| <a href="#wholePart">wholePart</a> <a href="#fraction">fraction</a>? <a href="#exponent">exponent</a></pre></td>
          <td align='left'> <p>A real number representable in IEEE double precision.</p></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='charConst'></a></pre></td>
          <td align='right'> <pre>charConst</pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left' colspan="2"> <pre>  '\\' anyof(&quot;btnfr\&quot;'\\&quot;)
| '\\' 'x' <a href="#digit16">digit16</a>*2 <font class="comment"># not yet implemented</font>
| !'\'' !'&quot;' .</pre></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='Char'></a></pre></td>
          <td align='right'> <pre><font><b>Char</b></font></pre></td>
          <td align='center'> <pre><font> ::= </font></pre></td>
          <td align='left'> <pre><font>'\'' (<a href="#charConst">charConst</a> | '&quot;') '\''</font></pre></td>
          <td align='left'> <p>A Unicode character.</p></td>
        </tr>
        <tr valign='top'>
          <td align='right'> <pre><a name='String'></a></pre></td>
          <td align='right'> <pre><b>String</b></pre></td>
          <td align='center'> <pre>::=</pre></td>
          <td align='left'> <pre><font>'&quot;' (<a href="#charConst">charConst</a>
     | '\''
     | '\\' '\n'
    )* '&quot;'</font></pre></td>
          <td align='left'> <p>A string of Unicode characters.</p></td>
        </tr>
      </table>
      <p>In a literal string, a backslash followed by a newline is ignored --
        the backslash eats the newline.</p>
      <p>Note that Real64 includes both 0.0 and -0.0. These are distinct, even
        though they represent the same real number.</p>
      <blockquote>
        <h2>Rationale</h2>
        <p>We allow '_' (underbar) characters within digit sequences so that long
          digit sequences can be broken up for readability. For example, the number
          of cents in 1.3 million dollars can be written as &quot;1_300_000_00&quot;.
          (Is it PERL that also allows this?)</p>
        <p>For convenience, we allow but do not require single quotes to be escaped
          in double quoted literals, and vice versa.</p>
        <p>For convenience, we allow multi-line string literals without per-line
          delimeters, even though reviewers can become confused about what they're
          looking at. Syntax highlighting SHOULD be used to make literals visibly
          distinct from non-literal source text during reviews.</p>
      </blockquote>
      <!-- #EndEditable --></TD>
    <TD WIDTH="10%">&nbsp;</TD>
  </TR>
  <TR VALIGN="TOP">
    <TD WIDTH="10%">&nbsp;</TD>
    <TD> <hr> <div align="center">
        <table width="100%" cellpadding="4" cellspacing="0">
          <tr>
            <td>
              <table align="left" cellpadding="2">
                <tr>
                  <td valign="top" align="left" colspan="3"><a href="../index.html"><img src="../images/e-lambda.gif" width="32" height="32" border="0" alt="ERights Home"></a>
                    <!-- #BeginEditable "Path2" -->&nbsp;<!-- #EndEditable --></td>
                </tr>
                <tr>
                  <td valign="top" align="right"><!-- #BeginEditable "PrevButton2" --><img src="../images/prev-gray.gif" width="64" height="32" alt="Prev"><!-- #EndEditable --></td>
                  <td valign="bottom" align="left"><!-- #BeginEditable "FirstButton2" -->x<!-- #EndEditable --></td>
                  <td valign="top" align="left"><!-- #BeginEditable "NextButton2" -->
                    <img src="../images/next-gray.gif" width="64" height="32" alt="Next"><!-- #EndEditable --></td>
                </tr>
              </table>
            </td>
            <td> <table border="3" align="center" cellpadding="6" cellspacing="3">
                <tr>
                  <td> <div align="center"><font size="-1"><a href="../elib/index.html">ELib</a>
                      &nbsp;&nbsp; <a href="../elang/index.html">E Language</a>
                      &nbsp;&nbsp; <a href="../smart-contracts/index.html">Smart
                      Contracts</a> &nbsp;&nbsp; <a href="../related.html">Related</a>
                      </font></div></td>
                </tr>
                <tr>
                  <td> <div align="center"><font size="-1"><a href="../download/index.html">Download</a>
                      &nbsp;&nbsp; <a href="http://mumble.net/e/faq.html">FAQ</a>
                      &nbsp;&nbsp; <a href="../javadoc/index.html">API</a> &nbsp;&nbsp;
                      <a href="http://www.eros-os.org/pipermail/e-lang/">Mail
                      Archive</a> &nbsp;&nbsp; <a href="../donate.html">Donate</a></font></div></td>
                </tr>
              </table></td>
            <td><div align="right">
                <p><i>email webmaster-at-erights.org</i> <br>
                  or <a href="http://bugs.sieve.net/bugs/?func=addbug&amp;group_id=16380"><i>report
                  bug</i></a> (including <a href="http://validator.w3.org/check/referer">invalid
                  html</a>) </p>
                <p><a href="http://www.epic.org/crypto/"><img src="../images/key.gif" width="37" height="19" alt="Golden Key Campaign" border="0"></a>&nbsp;<a href="http://www.eff.org/br/"><img src="../images/ribbon.gif" width="18" height="30"
alt="Blue Ribbon Campaign" border="0"></a> <a href="http://www.stoppoliceware.org/"><img src="../images/stoppoliceware_gray_88x32.gif" width="88" height="32" border="0" alt="Stop Policeware Campaign"></a>
              </div></td>
          </tr>
        </table>
      </div></TD>
    <TD WIDTH="10%" valign="bottom">&nbsp;</TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate --></HTML>
