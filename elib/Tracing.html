<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<!--last modified on Saturday, October 03, 1998 04:19 PM -->
<HTML><!-- #BeginTemplate "/Templates/pink.dwt" --><!-- DW6 -->
<HEAD>
<!-- #BeginEditable "doctitle" --> 
<TITLE>The Tracing Interface</TITLE>
<!-- #EndEditable --> 
<meta http-equiv=content-type content="text/html; charset=UTF-8">
<meta name="Author" content="Mark S. Miller">
<link rel=author rev=made title="Mark S. Miller">
<META NAME="description" CONTENT="E: Cryptographic Capabilities for Distributed Smart Contracting">
<META NAME="keywords" CONTENT="p2p, p2p language, p2p computing, p2p objects, secure p2p, p2p capabilities, object oriented p2p,
  capability-based p2p, Capability Security, Capabilities, Cryptography, Distributed Objects, Distributed
  Language, Distributed Capabilities, Lambda Calculus, Scripting Language, Distributed Language, Persistent
  Language, Persistent Capabilities, Persistent Objects, Java Shell, Capability Shell, Scripting Java, Smart
  Contracting, Agoric E-Commerce, Open Source, Message pipelining, quasi literal, vat, event loop, granovetter diagram ">
<link rel="stylesheet" href="../erights.css" type="text/css">
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFEEDD" LINK="#0000FF" VLINK="#800080">
<TABLE BORDER="0" width="100%">
  <TR VALIGN="TOP"> 
    <TD WIDTH="10%">&nbsp; </TD>
    <TD> <TABLE BORDER="0" WIDTH="100%">
        <TR> 
          <TD ALIGN="LEFT" valign="top"> <table cellpadding="2">
              <tr> 
                <td valign="top" align="left" colspan="3"><a href="../index.html"><img src="../images/e-lambda.gif" width="32" height="32" border="0" alt="ERights Home"></a> 
                  <!-- #BeginEditable "Path" -->/&nbsp;<a href="index.html">elib</a>&nbsp;<!-- #EndEditable --></td>
              </tr>
              <tr> 
                <td valign="top" align="right"><!-- #BeginEditable "PrevButton" --><a href="legacy/index.html" title="Back to: Living with a Legacy"><img src="../images/prev.gif" width="64" height="32" alt="Back to: Living with a Legacy" border="0"></a><!-- #EndEditable --></td>
                <td valign="bottom" align="left"><!-- #BeginEditable "FirstButton" --><!-- #EndEditable --></td>
                <td valign="top" align="left"><!-- #BeginEditable "NextButton" --><a href="ElibCodingConventions.html" title="On to: Java/ELib Coding Conventions"><img src="../images/next.gif" width="64" height="32" alt="On to: Java/ELib Coding Conventions" border="0"></a><!-- #EndEditable --></td>
              </tr>
            </table></TD>
          <TD rowspan="2" ALIGN="RIGHT"> <P ALIGN="RIGHT"><FONT SIZE="7"><!-- #BeginEditable "BigTitle" --><FONT SIZE="7"><B>The 
              Tracing<br>
              Interface </B></FONT><!-- #EndEditable --></FONT> </TD>
        </TR>
        
      </TABLE>
      <hr> <!-- #BeginEditable "LongBody" -->
      <p>When tracing, you post trace messages with a particular <u>level</u> 
        that refer to a particular <u>subsystem</u>. Tracing messages have two 
        possible destinations: the <u>log</u> or the <u>transient buffer</u>. 
        The same message can go to both the log and the trace buffer.</p>
      <p>At present, the log goes to standard error. In the future, it will go 
        to a disk file by default. (You will still be able to send it to standard 
        error.) </p>
      <p>The transient buffer is normally stored invisibly. You can dump it to 
        a disk file or standard error. Unlike the log, older messages in the 
        transient buffer are thrown away to make room for new ones.</p>
      <p>
      <hr>
      <p></p>
      <p><a href="#priority_levels">Priority levels</a><br>
        <a href="#subsystems">Subsystems</a></p>
      <p>Information for programmers</p>
      <ul>
        <li><a href="#adding_tracing_statements">Adding tracing statements</a> 
        </li>
        <li><a href="#Timing_support_code">Timing support</a></li>
        <li><a href="#tracing_objects_including_exceptions">Tracing objects, including 
          exceptions</a> </li>
        <li><a href="#controlling_tracing_at_runtime">Controlling tracing at runtime</a> 
        </li>
        <li><a href="#Reporting_bugs_to_users">Reporting bugs to users</a> </li>
        <li><a href="#Using_tracing_effectively">Using tracing effectively</a></li>
      </ul>
      <p>Controlling tracing at launch time</p>
      <ul>
        <li><a href="#launch_time_control_of_priority_threshol">Which priority 
          levels are traced<br>
          </a></li>
        <li><a href="#Launch_time_control_of_timing">Timing messages</a></li>
        <li><a href="#controlling_the_log_at_launch_time">The log</a> </li>
        <li><a href="#controlling_the_transient_buffer_at_laun">The transient 
          buffer</a></li>
      </ul>
      <p><a href="#output_format">Output format</a></p>
      <p>Controlling tracing through the Microcosm log window</p>
      <ul>
        <li><a href="#Changing_tracing_levels">Which priority levels are traced</a> 
        </li>
        <li><a href="#Changing_timing_from_log">Timing messages</a></li>
        <li><a href="#Dumping_the_transient_buffer">Dumping the transient buffer</a> 
        </li>
        <li><a href="#Other_controls">Other controls</a></li>
      </ul>
      <p>(There will be a more complete <a href="../javadoc/org/erights/e/develop/trace/Trace.html">javadoc 
        for the Trace class</a> someday.)</p>
      <p align="CENTER"><a name="priority_levels"></a></p>
      <p>
      <hr>
      <p></p>
      <p><b><i><font face="Arial">Priority levels</font></i></b></p>
      <p>Here are the priority levels. The log and the transient buffer have separate 
        priority <u>thresholds</u><b>. </b>Trace messages below the threshold 
        are ignored. The threshold can be set at program launch time. It can also 
        be changed at runtime.</p>
      <ul>
        <li><b>Error </b>messages report on some internal error. They don't necessarily 
          lead to the system stopping, but they might. Error messages always appear 
          in both the log and the transient buffer - you can't set either threshold 
          above <b>error</b>. </li>
        <li><b>Warning </b>messages are not as serious as errors, but they're 
          signs of something odd. </li>
        <li><b>World</b> messages track the state of the world as a whole. They 
          are the sort of things world operators ask for specifically, such as 
          "can you tell me when someone connects." They should appear only occasionally, 
          much less often than once per second. By default, messages of this priority 
          (and higher) are stored in the on-disk log. <br>
          <br>
          If the code being traced is infrastructure code, it may be unaware of 
          the "world" that uses it. Such code should use messages at this level 
          when the programmer wants them always to go into a permanent log. So 
          there shouldn't be too many of them, and they should record events of 
          interest at some time arbitrarily distant. </li>
        <li><b>Usage</b> messages are used to answer the question "who did what 
          up to the point the bug appeared?" ("Spock entered Azturf. Spock started 
          trading with Kyra. Kyra gave Spock a diamond in exchange for a lump 
          of coal. Kyra spoke.") They are also used to collect higher-level usability 
          information. By default, messages of this priority (and higher) are 
          stored in the transient buffer. <br>
          <br>
          Infrastructure code should use this level for messages that allow the 
          programmer to figure out roughly how the program got to some point where 
          it broke <i>when someone else - probably an end user - ran it</i>. These 
          messages might make the difference between a non-reproducible bug you 
          can't figure out and one you can. </li>
        <li><b>Event </b>messages describe the major actions the system takes 
          in response to user actions. The distinction between this category and 
          <b>debug</b> is fuzzy, especially since <b>debug</b> is already used 
          for many messages of this type. However, <b>event</b> can be used to 
          log specific user gestures for Ellen, and to log information for testers. 
          I've found it useful to set the transient buffer's threshold to <b>event</b> 
          and log enough information there to be able to figure out generally 
          what the code was doing before it broke. If I need more detail, I rerun 
          the program with the threshold set to <b>debug</b>. <br>
          <br>
          Programmers of infrastructure code use this level when they're running 
          some of their code, want a bit more detail about what it's doing, but 
          don't want to see all the nitty-gritty that <b>debug</b> level provides. 
          Key difference between this level and <b>usage</b> is that the developer 
          is setting this level to get messages that are useful in a debugging 
          situation, or one where he or she is just trying the code out. (Testers 
          might also run at the <b>event</b> level, since they expect to find 
          bugs. <b>usage</b> level is for people who don't, but want to be able 
          to provide info if they do.) </li>
        <li><b>Debug</b> messages provide more detail for people who want to delve 
          into what's going on, probably to figure out a bug. </li>
        <li><b>Verbose </b>messages provide even more detail than <b>debug</b>. 
          They're probably mainly used when first getting the code to work. </li>
      </ul>
      <p><b><i><font face="Arial"><a name="subsystems">Subsystems</a></font></i></b></p>
      <p>Some subsystems are predefined. They are: <b>agent, comm, console, dgc 
        </b>(distributed garbage collector), <b>dynamics, eruntime, file, fonts, 
        gui, io, persist </b>(persistence subsystem), <b>plruntime</b> (Pluribus 
        runtime), <b>repository, scene, sound </b>(VoxChat, DirectSound)<b>, startup, 
        timers, trace, ui </b>(the classes involved in going from unum to framework 
        and back), <b>una, vat</b>. You can also create your own subsystems at 
        runtime.</p>
      <p>Each subsystem can have its own priority threshold for both the log and 
        the transient buffer.</p>
      <p align="CENTER"><a name="adding_tracing_statements"></a></p>
      <p>
      <hr>
      <p></p>
      <p><b><i><font face="Arial">Adding tracing statements to code</font></i></b></p>
      <p><font face="Arial">Using a predefined subsystem</font></p>
      <p>To log a debug-level message about the Fonts subsystem, you would write:</p>
      <blockquote><tt>if (Trace.fonts.debug) { Trace.fonts.debugm("Your message 
        here"); }</tt></blockquote>
      <p>The test prevents an expensive call when the threshold is higher than 
        "debug". Notice that each priority level has its own tracing message: 
        errorm(), debugm(), worldm(), and so on. The trailing 'm' (for "method") 
        is there because the E compiler once had problems when fields and methods 
        had the same name. Although those problems seem to have gone away, Danfuzz 
        prudently suggested avoiding this edge case.</p>
      <p>(For backwards compatibility, the "$" message is also supported - see 
        below - but don't use it in this context. It is deprecated.)</p>
      <p>If you're adding tracing statements to code that you know cannot be executed 
        frequently, you can reduce clutter by writing:</p>
      <blockquote><tt>Trace.fonts.warningm("Take a look at these: " + obj1 + 
        ", " + obj2);</tt></blockquote>
      <p>All of the tracing methods check the appropriate variable themselves, 
        so the message will only be posted if <tt>warning</tt> is true. Note 
        that every call will pay the overhead of constructing a string from the 
        two strings and two objects, which is ridiculously expensive.</p>
      <p><font face="Arial">Creating your own subsystem</font></p>
      <p>To create your own subsystem, write:</p>
      <blockquote><tt>static private Trace subsystemTrace = new Trace("subsystem");</tt></blockquote>
      <p>As with predefined subsystems, the threshold is defined at program launch 
        time. Be careful to make the trace variable static; you don't need one 
        per instance.</p>
      <p>After creating it, you use your private Trace object just like a predefined 
        one:</p>
      <blockquote><tt>if (subsystemTrace.world) { subsystemTrace.worldm("Your 
        message here"); }</tt></blockquote>
      <p><font face="Arial">Tracing a class</font></p>
      <p>The Trace constructor can also take no arguments:</p>
      <blockquote><tt>static private Trace tr = new Trace();</tt></blockquote>
      <p>The resulting Trace object treats the current class as a subsystem. This 
        was the only behavior of the previous version of Trace. In old code, you'll 
        see calls like:</p>
      <blockquote><tt>if (tr.error) { tr.$("Your message here"); }</tt></blockquote>
      <p>"$()" is a synonym for "debugm()". (The difference between "debugm()" 
        and "errorm()" matters slightly; see below.)</p>
      <p><i>Note: this version of the trace constructor is currently not available. 
        I'm leaving the documentation here in hopes that it will someday be re-enabled. 
        </i></p>
      <p><b><font face="Arial"><i><a name="tracing_objects_including_exceptions"></a><a name="controlling_tracing_at_runtime"></a><a name="other_tracing_functions"></a></i><a name="other_tracing_functions"></a></font><a name="other_tracing_functions"></a></b><a name="other_tracing_functions"><a name="Timing_support_code"></a><b><font face="Arial"><i>Timing 
        support</i></font></b></a></p>
      <p>In addition to the variables described above, there is a <tt>timing</tt> 
        variable that can be used to log messages used in performance tuning. 
        You use it the same way as other variables:</p>
      <blockquote><tt>if (tr.timingm) { tr.timingm("Your message here"); }</tt></blockquote>
      <p>Note that the variable has an associated <tt>timingm</tt> method 
        that identifies the message as a timing message. </p>
      <p>The timing variable is entirely independent of the other variables (<tt>error</tt>, 
        etc.). </p>
      <p><b><i><font face="Arial">Tracing objects, including exceptions</font></i></b></p>
      <p>All of the trace messages can take a second argument, an arbitrary Java 
        Object. Most objects are printed with <tt>toString</tt>. Throwables 
        are handled specially. They are printed as a stack traceback. Nested exceptions 
        are handled (as with <tt>EthreadGroup.reportException</tt>).</p>
      <p>You can achieve the same effect with calls of the form <tt>tr.<i>level</i>ReportException(Throwable 
        t, String msg)</tt>, where <i>level</i> is verbose, debug, event, usage, 
        world, warning, or error. (Sorry about the inconsistent order of arguments: 
        the perils of simultaneous development.)</p>
      <p>We recommend that the code that disposes of an exception should log it. 
        That way, exceptions are always logged exactly once. So any code that 
        catches and does not rethrow an exception should look like this:</p>
      <pre>&#9;try {
        } catch (Exception e) {
&#9;    myTrace.errorm("Here's the stack trace for the bug: ", e);
&#9;    ...
        }</pre>
      <p>(Note: this code is going to have to decide whether the exception represents 
        a bug or not. An errorm() isn't appropriate if it's not a bug.)</p>
      <p>If you catch an exception and throw a different exception, you should 
        either log the discarded exception or throw a NestedThrowable with the 
        original exception included. Either way, the exception will end up in 
        the log.</p>
      <p><b><i><font face="Arial">Controlling tracing at runtime</font></i></b></p>
      <p>The trace subsystem is controlled by giving it properties. The interface 
        is <tt>TraceController.setProperty(String property, String value)</tt>. 
        The properties are given in the next major section.</p>
      <p><b><i><font face="Arial"><a name="Reporting_bugs_to_users"></a>Reporting 
        bugs to users</font></i></b></p>
      <p><b>error</b>-level trace messages are always placed in the log. They 
        do no good there unless someone looks at them. Your code can use two pairs 
        of methods to direct a user's attention to the log. </p>
      <p>The first pair will notify a user who has volunteered to look at bugs.</p>
      <dir> 
        <dir> 
          <p><tt>TraceController.notifyOptional();<br>
            tr.notifyOptional();</tt></p>
        </dir>
      </dir>
      <p> <a name="Using_tracing_effectively"></a><tt>notifyOptional</tt> 
        first checks if the user has volunteered. If so, it pops up a non-modal 
        dialog box directing her to the location of the log.</p>
      <p>The second pair unilaterally informs a user of a fatal error.</p>
      <dir> 
        <dir> 
          <p><tt>TraceController.notifyFatal();<br>
            tr.notifyFatal();</tt></p>
        </dir>
      </dir>
      <p> <tt>notifyFatal</tt> pops up a modal dialog box telling the user 
        that a fatal bug has been discovered, informing her of the location of 
        the log, and telling her that the product is about to exit. When she exits 
        the dialog box, the product exits. This routine never returns.</p>
      <p>What code should call these methods?</p>
      <ul>
        <li>Any code that throws away an exception-representing-a-bug has by definition 
          resolved (somehow) a nonfatal error. It should invoke notifyOptional():</li>
      </ul>
      <pre>&#9;try {
        } catch (Exception e) {
&#9;    myTrace.errorm("Here's the stack trace for the bug: ", e);
&#9;    Trace.notifyOptional();
        }</pre>
      <ul>
        <li>The exception-catcher of last resort will call one of the two methods. 
          Most likely, the default will be to call notifyOptional(), but it may 
          call notifyFatal() for particular kinds of exceptions. </li>
        <li>A method that finds a bug in itself and immediately fixes it should 
          send a notifyOptional():</li>
      </ul>
      <pre>&#9;if (myHashtable == null) { 
&#9;   // darn, I wonder why that happened.
&#9;   // doesn't matter, an empty one will work well enough.
&#9;   myHashTable = new Hashtable();
&#9;   // Log my state for debugging.
&#9;   myTrace.errorm("null hash table?", this);
&#9;   Trace.notifyOptional();
&#9;}  </pre>
      <ul>
        <li>Code that <i>knows</i> it has found a fatal bug can call notifyFatal(), 
          but it's probably better to just throw some guaranteed-to-be-fatal exception 
          type. That way you won't have to write code like:</li>
      </ul>
      <dir> 
        <pre>&#9;int foo() {
&#9;    ...
&#9;    if (somethingFatallyHorribleHappened) {
&#9;&#9;Trace.notifyFatal();
&#9;&#9;return 0; // shut up the compiler.
&#9;    }</pre>
        <dir> 
          <p>You also give a caller a chance to dump its state to the trace log.</p>
        </dir>
      </dir>
      <p><b><i><font face="Arial">Using tracing effectively</font></i></b></p>
      <p>It's common for in-house testers and other programmers to stumble across 
        a bug and wonder what they did to provoke it. The result is all too often 
        an unreproducible bug, an inexact description of the circumstances, and 
        a log that doesn't contain much detail. And the programmer's stuck knowing 
        there's a bug somewhere, but unable to fix it. (The Inspector is wonderful, 
        but sometimes you need to know how you got to the hosed state it lets 
        you inspect.)</p>
      <p>The situation is worse with beta testers or customers. They are notorious 
        for providing useless bug reports (when they provide any at all).</p>
      <p>With the internal log, people be able to notice a bug, dump a better 
        trace of what they did to get to that point, and give much more detail 
        to the programmer. Except that right now (October 97), the internal log 
        doesn't show much. For example, you can't tell from it that an avatar 
        walked between regions.</p>
      <p>So you can help your fellow programmers by:</p>
      <ol>
        <li>Adding <b>usage</b> level trace messages that log major (once per 
          user action) events.</li>
        <li>Adding <b>event</b> level messages that act as "signposts", so that's 
          you'll be able to tell from the trace roughly what path your code is 
          taking. (Testers may often run with event-level tracing turned on for 
          specific subsystems.)</li>
        <li>Being tolerant if testers ask you to upgrade, downgrade, or add tracing 
          statements.</li>
        <li>Converting EStdio or System.out messages to trace messages.</li>
        <li>Converting old-style no-argument Trace constructors to use subsystem 
          names, so that it's easier to change the tracing level for big chunks 
          of code at once.</li>
      </ol>
      <p>You can also help yourself more directly. In the past, I've had good 
        luck with similar systems when I followed this discipline:</p>
      <ul>
        <li>I got a bug report. </li>
        <li>I spent way too much time finding the problem. </li>
        <li>I added debugging code that would make similar problems obvious next 
          time. This could be trace code, assertions, inspector-like hooks, whatever.</li>
      </ul>
      <p>Over time, the code grew into something that practically shouted out 
        its bugs.</p>
      <p>Trace is not speedy because it makes us painfully reconstruct at runtime 
        information readily available at compile time. (Think __LINE__ and __FILE__ 
        in C++.) But it can put 385 messages/second into the buffer on a standard 
        development machine, which should be sufficient. </p>
      <p>This is important. I once had dinner with some people in a roughly similar 
        product space, and they described their testing/build environment. Their 
        Gordie-equivalent in charge of all infrastructure code described their 
        tracing system with the loving tone of English nobility describing a devoted 
        servant.</p>
      <p>
      <hr>
      <p></p>
      <p><b><i><font face="Arial"><a name="launch_time_control_of_priority_threshol">Launch 
        time control of priority thresholds</a></font></i></b></p>
      <p>Priority thresholds are first set at launch time by properties (either 
        on the command line or in property files). </p>
      <p>The <u>default threshold</u> applies to all subsystems that have not 
        been given their own thresholds. To set the default threshold for the 
        transient buffer and log (respectively), use:</p>
      <blockquote>TraceBuffer_default=<i>level<br>
        </i>TraceLog_default=<i>level</i></blockquote>
      <p>Where <i>level</i> is one of "error", "warning", "usage", etc.</p>
      <p>To set the threshold for a particular subsystem, use:</p>
      <blockquote>TraceBuffer_<i>subsystem</i>=<i>level<br>
        </i>TraceLog_<i>subsystem</i>=<i>level</i></blockquote>
      <p>The subsystem name is not sensitive to case. Subsystem thresholds always 
        take priority over the default threshold, whether they're higher or lower 
        than it. </p>
      <p>You can cause the subsystem to once again track the default threshold 
        with:</p>
      <blockquote>TraceBuffer_<i>subsystem</i>=default<br>
        TraceLog_<i>subsystem</i>=default</blockquote>
      <p>Since a class is a subsystem, you can set the threshold with a property 
        like this:</p>
      <blockquote>TraceBuffer_java.lang.String=debug <br>
        TraceLog_java.lang.String=debug</blockquote>
      <p>Note that the fully-qualified classname is required. (In this version, 
        Pluribus and E classnames are not demangled. In a later version, they 
        will be.)</p>
      <p><b><i><font face="Arial"><a name="controlling_the_log_at_launch_time"></a><a name="Launch_time_control_of_timing">Launch 
        time control of timing</a></font></i></b></p>
      <p>Timing (performance) messages can be turned on at launch time with properties 
        of this form:</p>
      <blockquote>TraceBuffer_<i>subsystem</i>_timing=on<br>
        TraceLog_<i>subsystem</i>_timing=on</blockquote>
      <p>You can use "true" as a synonym for "on". Timing messages can be turned 
        off with:</p>
      <blockquote>TraceBuffer_<i>subsystem</i>_timing=off<br>
        TraceLog_<i>subsystem</i>_timing=off</blockquote>
      <p>You can use "false" as a synonym for "off".</p>
      <p>There is no way to turn timing on or off for all subsystems at once. 
        That doesn't seem useful. </p>
      <p><b><i><font face="Arial">Controlling the log at launch time</font></i></b></p>
      <p>By default, the log appears on standard error. To turn it off, use:</p>
      <dir> 
        <dir> 
          <p>TraceLog_write=false</p>
        </dir>
      </dir>
      <p>At some point (when more of Microcosm uses the tracing system), the default 
        log will be a file. The default logfile is "ECLog.<i>yyyymmddhhmmss.</i>txt" 
        in the current directory. (Note: the current directory can change while 
        Microcosm is running. When there's some official source of default directory, 
        the trace code will be changed to use it.) The date field records the 
        time Microcosm started (strictly, the time when the tracing system was 
        initialized). You can override the directory with:</p>
      <dir> 
        <dir> 
          <p>TraceLog_dir=<i>pathname</i></p>
        </dir>
      </dir>
      <p>To change the log's tag from "ECLog" to something else, use:</p>
      <dir> 
        <dir> 
          <p>TraceLog_tag=<i>new</i></p>
        </dir>
      </dir>
      <p>You can completely override the log name (to give you something like 
        "myfoo.log.bar") with:</p>
      <dir> 
        <dir> 
          <p>TraceLog_name=<i>name</i></p>
        </dir>
      </dir>
      <p>The directory still applies, unless <i>name</i> is an absolute pathname.</p>
      <p>To write to standard error, use</p>
      <dir> 
        <dir> 
          <p>TraceLog_name=-</p>
        </dir>
      </dir>
      <p>(That's a dash.)</p>
      <p><i>Note: during the interim while standard error is the default destination, 
        use "TraceLog_tag=ECLog" to use the "ECLog.yyyymmddhhmmss.txt" logfile 
        described above.</i></p>
      <p>By default, logs have a limited size of 500,000 characters. Past that 
        size, the log will, by default, be closed, renamed to ECLog.<i>yyyymmddhhmmss</i>.<i>sequence</i>.txt, 
        and a new log will be opened. The sequence number is 0 if no file named 
        ECLog.<i>yyyymmddhhmmss</i>.0.txt exists. Otherwise, it is <i>N</i>+1, 
        where <i>N</i> is the largest sequence number that already exists. If 
        you picked a different file format (using TraceLog_name), the sequence 
        number is appended.</p>
      <p>If, when tracing is started, a matching log exists (which should only 
        happen if TraceLog_name was used), a new one is created and the old one 
        is renamed as above. Whenever a log is renamed, the old and new names 
        are logged as a <b>world</b> level message, so they will probably appear 
        in the new log.</p>
      <p>This behavior can be modified as follows:</p>
      <table cellspacing=0 border=0 cellpadding=7 width=638>
        <tr>
          <td width="50%" valign="TOP"> 
            <p>TraceLog_size=<i>new-maximum-size</i>
          </td>
          <td width="50%" valign="TOP"> 
            <p>// size is in characters.
          </td>
        </tr>
        <tr>
          <td width="50%" valign="TOP"> 
            <p>TraceLog_size=default
          </td>
          <td width="50%" valign="TOP"> 
            <p>// back to the default
          </td>
        </tr>
        <tr>
          <td width="50%" valign="TOP"> 
            <p>TraceLog_size=unlimited
          </td>
          <td width="50%" valign="TOP"> 
            <p>// the log never fills up until the file system does.
          </td>
        </tr>
        <tr>
          <td width="50%" valign="TOP"> 
            <p>TraceLog_backups=1<br>
              TraceLog_backups=one
          </td>
          <td width="50%" valign="TOP"> 
            <p>// there will be at most one backup file. It will have sequence 
              number 0. If the backup file already exists, it will be overwritten.
          </td>
        </tr>
        <tr>
          <td width="50%" valign="TOP"> 
            <p>TraceLog_backups=many
          </td>
          <td width="50%" valign="TOP"> 
            <p>// return to default behavior, always backing up to a file with 
              an unused sequence number.
          </td>
        </tr>
      </table>
      <p>&nbsp;</p>
      <p><b><i><font face="Arial"><a name="controlling_the_transient_buffer_at_laun">Controlling 
        the transient buffer at launch time</a></font></i></b></p>
      <p>The buffer by default stores at most 500 messages. (Note: messages, not 
        bytes.) When the 501'th message arrives, the first is discarded. The buffer 
        size can be modified with:</p>
      <dir> 
        <dir> 
          <p>TraceBuffer_size=<i>new-maximum-size<br>
            </i>TraceBuffer_size=default<br>
            TraceBuffer_size=unlimited</p>
        </dir>
      </dir>
      <p>Normally, trace messages in the buffer are not displayed. Use the <a href="#Changing_tracing_levels">Microcosm 
        log window</a> to display them.</p>
      <p align="CENTER"><a name="output_format"></a></p>
      <p>
      <hr>
      <p></p>
      <p><b><i><font face="Arial">Output format</font></i></b></p>
      <p>Log output is verbose. Here is what log output looks like:</p>
      <dir> 
        <dir> 
          <p>=== 1997/09/22 13:52:09 (DirAndTag.main:DirAndTag.java:26) WLD<br>
            comm: That's all, folks - end of test.</p>
        </dir>
      </dir>
      <p>Reading from left to right (not the way you usually scan logs), this 
        means that:</p>
      <ol>
        <li>The message was posted at 13:52 on September 22, 1997. Dates are in 
          local time. Note that the format is year/month/date. That makes logs 
          sortable by date, and avoids confusion about whether 07/08/97 is a date 
          in July or August.</li>
        <li>The trace message came from the method <tt>main</tt> in the class 
          <tt>DirAndTag</tt>. The particular call was on line 26 of DirAndTag.java.</li>
        <li>The message was posted with priority <b>world</b>.</li>
        <li>The message is about the subsystem <b>comm</b>.</li>
        <li>The actual message is " That's all, folks - end of test."</li>
      </ol>
      <p>If the trace call had been through a trace object created for a class, 
        it would have looked like:</p>
      <dir> 
        <dir> 
          <p>=== 1997/09/22 13:52:09 (DirAndTag.main:DirAndTag.java:26) WLD<br>
            ec.e.run.DirAndTag: That's all, folks - end of test.</p>
        </dir>
      </dir>
      <p>Note that the classname-as-subsystem is fully qualified, but the method 
        name is not (to save space). </p>
      <p>For reference, the level abbreviations are:</p>
      <table cellspacing=0 border=0 cellpadding=7 width=175>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>ERR
          </td>
          <td width="58%" valign="TOP"> 
            <p>Error
          </td>
        </tr>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>WRN
          </td>
          <td width="58%" valign="TOP"> 
            <p>Warning
          </td>
        </tr>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>WLD
          </td>
          <td width="58%" valign="TOP"> 
            <p>World
          </td>
        </tr>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>USE
          </td>
          <td width="58%" valign="TOP"> 
            <p>Usage
          </td>
        </tr>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>EVN
          </td>
          <td width="58%" valign="TOP"> 
            <p>Event
          </td>
        </tr>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>DBG
          </td>
          <td width="58%" valign="TOP"> 
            <p>Debug
          </td>
        </tr>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>VRB
          </td>
          <td width="58%" valign="TOP"> 
            <p>Verbose
          </td>
        </tr>
      </table>
      <p>&nbsp;</p>
      <table cellspacing=0 border=0 cellpadding=7 width=174>
        <tr>
          <td width="42%" valign="TOP"> 
            <p>TIM
          </td>
          <td width="58%" valign="TOP"> 
            <p>Timing
          </td>
        </tr>
      </table>
      <p>&nbsp;</p>
      <p>
      <hr>
      <p></p>
      <p><b><i><font face="Arial">Controlling tracing through the Microcosm log 
        window</font></i></b></p>
      <p><a name="Changing_tracing_levels"></a>The Microcosm log window can control 
        the trace subsystem. For a brief summary of commands, use</p>
      <dir> 
        <dir> 
          <p>trace help</p>
        </dir>
      </dir>
      <p><font face="Arial">Changing the priority thresholds that control which 
        messages are traced</font></p>
      <p>Priority thresholds for the log are changed with commands of this form:</p>
      <dir> 
        <dir> 
          <p>tracelog <i>subsystem threshold</i></p>
        </dir>
      </dir>
      <p>You can put a comma between the subsystem and the threshold. For the 
        time being, "trace" is a synonym for "tracelog".</p>
      <p>To change the default threshold, use:</p>
      <dir> 
        <dir> 
          <p>tracelog default<i> threshold</i></p>
        </dir>
      </dir>
      <p>(Note: if you change the threshold to "debug", you'll regret it. It produces 
        an enormous quantity of output.)</p>
      <p>Thresholds for the buffer are changed with:</p>
      <dir> 
        <dir> 
          <p>tracebuffer <i>subsystem threshold</i></p>
        </dir>
      </dir>
      <p><font face="Arial"><a name="Changing_timing_from_log"></a>Timing messages</font></p>
      <p>Timing messages can be turned on with:</p>
      <dir> 
        <dir> 
          <p>tracebuffer <i>subsystem</i>_timing<i> </i>on<br>
            tracelog <i>subsystem</i>_timing on</p>
        </dir>
      </dir>
      <p>"true" can be used instead of "on". Timing messages can be turned off 
        with:</p>
      <dir> 
        <dir> 
          <p>tracebuffer <i>subsystem</i>_timing<i> </i>off<br>
            tracelog <i>subsystem</i>_timing off</p>
        </dir>
      </dir>
      <p>"false" can be used instead of "off".</p>
      <p><font face="Arial"><a name="Dumping_the_transient_buffer"></a>Dumping 
        the transient buffer</font></p>
      <p><a name="Other_controls"></a>To dump the transient buffer's contents 
        to standard error, use:</p>
      <dir> 
        <dir> 
          <p>trace dump</p>
        </dir>
      </dir>
      <p>(You can also use "tracebuffer dump".) To dump it to a file, use:</p>
      <dir> 
        <dir> 
          <p>trace dump <i>filename</i></p>
        </dir>
      </dir>
      <p>The filename can be absolute or relative. If relative, it's relative 
        to the current working directory (wherever that is). Don't put spaces 
        in the filename.</p>
      <p><font face="Arial">Other controls</font></p>
      <p>Any of the properties that can be set at <a href="#controlling_the_log_at_launch_time">launch 
        time</a> can also be set through the log window. For example to change 
        the number of messages the trace buffer holds, use:</p>
      <dir> 
        <dir> 
          <p>tracebuffer size 5000</p>
        </dir>
      </dir>
      <p>Commands that change the name of the logfile take effect the next time 
        it is opened. To force it to be reopened, use:</p>
      <dir> 
        <dir> 
          <p>tracelog reopen true</p>
        </dir>
      </dir>
      <P ALIGN="left">&nbsp;
      <!-- #EndEditable --></TD>
    <TD WIDTH="10%" rowspan="2" align="right" valign="bottom"> </TD>
  </TR>
  <TR VALIGN="TOP"> 
    <TD WIDTH="10%">&nbsp;</TD>
    <TD> <hr>
      Unless stated otherwise, all text on this page which is either unattributed 
      or by Mark S. Miller is hereby placed in the public domain. 
        <div align="center"> 
        <table width="100%" cellpadding="4" cellspacing="0">
          <tr> 
            <td> <table align="left" cellpadding="2">
                <tr> 
                  <td valign="top" align="left" colspan="3"><a href="../index.html"><img src="../images/e-lambda.gif" width="32" height="32" border="0" alt="ERights Home"></a> 
                    <!-- #BeginEditable "Path2" -->/&nbsp;<a href="index.html">elib</a>&nbsp;<!-- #EndEditable --></td>
                </tr>
                <tr> 
                  <td valign="top" align="right"><!-- #BeginEditable "PrevButton2" --><a href="legacy/index.html" title="Back to: Living with a Legacy"><img src="../images/prev.gif" width="64" height="32" alt="Back to: Living with a Legacy" border="0"></a><!-- #EndEditable --></td>
                  <td valign="bottom" align="left"><!-- #BeginEditable "FirstButton2" --><!-- #EndEditable --></td>
                  <td valign="top" align="left"><!-- #BeginEditable "NextButton2" --><a href="ElibCodingConventions.html" title="On to: Java/ELib Coding Conventions"><img src="../images/next.gif" width="64" height="32" alt="On to: Java/ELib Coding Conventions" border="0"></a><!-- #EndEditable --></td>
                </tr>
              </table></td>
            <td> <table border="3" align="center" cellpadding="6" cellspacing="3">
                <tr> 
                  <td> <div align="center"><font size="-1"><a href="index.html">ELib</a> 
                      &nbsp;&nbsp; <a href="../elang/index.html">E Language</a> 
                      &nbsp;&nbsp; <a href="../smart-contracts/index.html">Smart 
                      Contracts</a> &nbsp;&nbsp; <a href="../related.html">Related</a> 
                      </font></div></td>
                </tr>
                <tr> 
                  <td> <div align="center"><font size="-1"><a href="../download/index.html">Download</a> 
                      &nbsp;&nbsp; <a href="http://mumble.net/e/faq.html">FAQ</a> 
                      &nbsp;&nbsp; <a href="../javadoc/index.html">API</a> &nbsp;&nbsp; 
                      <a href="http://www.eros-os.org/pipermail/e-lang/">Mail 
                      Archive</a> &nbsp;&nbsp; <a href="../donate.html">Donate</a></font></div></td>
                </tr>
              </table></td>
            <td><div align="right"> 
                <p><a href="https://sourceforge.net/tracker/?func=add&amp;group_id=75274&amp;atid=551529"><i>report 
                  bug</i></a> (including <a href="http://validator.w3.org/check/referer">invalid 
                  html</a>) </p>
                <p><a href="http://www.epic.org/crypto/"><img src="../images/key.gif" width="37" height="19" alt="Golden Key Campaign" border="0"></a>&nbsp;<a href="http://www.eff.org/br/"><img src="../images/ribbon.gif" width="18" height="30"
alt="Blue Ribbon Campaign" border="0"></a></div></td>
          </tr>
          
        </table>
      </div></TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate --></HTML>
