<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<!--last modified on Saturday, October 03, 1998 04:19 PM -->
<HTML><!-- #BeginTemplate "/Templates/pink.dwt" --><!-- DW6 -->
<HEAD>
<!-- #BeginEditable "doctitle" -->
<TITLE>3 Parts of Security</TITLE>
<!-- #EndEditable --> 
<meta http-equiv=content-type content="text/html; charset=UTF-8">
<meta name="Author" content="Mark S. Miller">
<link rel=author rev=made title="Mark S. Miller">
<META NAME="description" CONTENT="E: Cryptographic Capabilities for Distributed Smart Contracting">
<META NAME="keywords" CONTENT="p2p, p2p language, p2p computing, p2p objects, secure p2p, p2p capabilities, object oriented p2p,
  capability-based p2p, Capability Security, Capabilities, Cryptography, Distributed Objects, Distributed
  Language, Distributed Capabilities, Lambda Calculus, Scripting Language, Distributed Language, Persistent
  Language, Persistent Capabilities, Persistent Objects, Java Shell, Capability Shell, Scripting Java, Smart
  Contracting, Agoric E-Commerce, Open Source, Message pipelining, quasi literal, vat, event loop, granovetter diagram ">
<link rel="stylesheet" href="../../erights.css" type="text/css">
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFEEDD" LINK="#0000FF" VLINK="#800080">
<TABLE BORDER="0" width="100%">
  <TR VALIGN="TOP"> 
    <TD WIDTH="10%">&nbsp; </TD>
    <TD> <TABLE BORDER="0" WIDTH="100%">
        <TR> 
          <TD ALIGN="LEFT" valign="top"> <table cellpadding="2">
              <tr> 
                <td valign="top" align="left" colspan="3"><a href="../../index.html"><img src="../../images/e-lambda.gif" width="32" height="32" border="0" alt="ERights Home"></a> 
                  <!-- #BeginEditable "Path" -->/&nbsp;<a href="../index.html">elib</a>&nbsp;/&nbsp;<a href="index.html">capability</a>&nbsp;<!-- #EndEditable --></td>
              </tr>
              <tr> 
                <td valign="top" align="right"><!-- #BeginEditable "PrevButton" --><a href="overview.html" title="Back to: Overview: Capability Computation"><img src="../../images/prev.gif" width="64" height="32" alt="Back to: Overview: Capability Computation" border="0"></a><!-- #EndEditable --></td>
                <td valign="bottom" align="left"><!-- #BeginEditable "FirstButton" --><!-- #EndEditable --></td>
                <td valign="top" align="left"><!-- #BeginEditable "NextButton" --><a href="ode/index.html" title="On to: An Ode to the Granovetter Diagram"><img src="../../images/next.gif" width="64" height="32" alt="On to: An Ode to the Granovetter Diagram" border="0"></a><!-- #EndEditable --></td>
              </tr>
            </table></TD>
          <TD rowspan="2" ALIGN="RIGHT"> <P ALIGN="RIGHT"><FONT SIZE="7"><!-- #BeginEditable "BigTitle" --><FONT SIZE="7"><B>
              The Three Parts<br>
              of Security<font size="5"><br>
              by Bill Frantz</font></B></FONT><!-- #EndEditable --></FONT> </TD>
        </TR>
        
      </TABLE>
      <hr> <!-- #BeginEditable "LongBody" -->
      <p><i>The following is adapted from a message by Bill Frantz, originally
        posted on the SPKI list, and then reposted by Jonathan Shapiro on the
        EROS list. This web page adaptation and the title is by Mark Miller, and
        is posted with Bill's permission.</i>


      <blockquote>I [Bill] was asked in private mail: <br>
        &gt;I'd like the longer rant. I'm particularly interested in getting <br>
        &gt;practical examples of where distributed capabilities can be used <br>
        &gt;to solve enterprise/IS security problems. I'd like to see an <br>
        &gt;alternative to strong authentication and NT ACLs. </blockquote>

      <p>What we intuitively call security is really made up of three things:
        keeping objects secret, protecting objects from modification, and preventing
        the misuse of objects. We can really only algorithmically control two
        of these things.
      <p>We can keep an object secret by withholding the authority to access the
        object, or confining the computations which use the object. ACLs are a
        way of withholding access.
      <p>We can protect objects from modification by withholding the authority
        to modify them. ACLs also are a way of withholding modification authority.
      <p>We can't prevent something which has legitimate access to an object from
        miss-using that access. A simple example is a program which has the authority
        to erase files from a directory. There is no way we can prevent it from
        erasing a specific file in that directory. We must trust it not to erase
        that file whenever we run it.
      <p>We have already been considering the actors in a system informally. More
        formally, the actors are either people or programs. While people can not
        directly act on the computational objects in a system, there is usually
        a program e.g. the Unix shell, which will help people do anything they
        have the authority to do. The logon process needs to identify people so
        it will give their shell the proper authority. Once logon has authenticated
        the user, we can consider that the only actors are programs.
      <p>A critical issue is, what are the loyalties of the actors? People's loyalties
        are hard to determine, and most computer fraud is due to people failures
        rather than to technical security breaches. IMHO the best technical solution
        to people problems is tamper resistant audit trails.
      <p>The loyalty of the program is easier to determine. It is most closely
        aligned with the people who wrote it, not the person running it. (However,
        bugs make this alignment only approximate.) The fact the programs are
        loyal to their authors is what allows hostile viruses and Trojan horses
        to exist. The fact of bugs allows the never ending list of system penetrations
        based on overrunning some storage buffer.
      <p>Systems like NT ACLs fail because they have the implicit assumption that
        the loyalty of the program is to the person running it, so they consider
        the security problem solved when they can control people's access to objects.
        In these systems, when a user executes a program, a program instance is
        created which inherits all the authority of the user. If it is loyal to
        the user, there is no problem. However when its loyalty to its author
        causes it to abuse the authority of its user, there is a security problem.
      <p>We have several tools to reduce security exposures in our systems. We
        can use the principle of least privilege to sharply limit the authority
        programs have when they run. For example, we can run the program with
        erase authority described above with only the authority to erase specific
        files. By only giving it access to the computational objects it needs
        to do its job, we can prevent it from accessing or modifying other objects
        in the system.
      <p>We can also control where programs can transfer the data they can access
        by controlling their communication channels. This technique is called
        confinement. (See Butler Lampson's paper, "<a href="http://www.cis.upenn.edu/%7EKeyKOS/Confinement.html">A
        Note on the Confinement Problem</a>", Communications of the ACM, V 16,
        N 10, October, 1973. for a discussion of its limitations.) Systems which
        allow programs to write files in essentially any directory can't confine
        those programs.
      <p>It should be noted that in a free society, people can not be confined
        as a way of keeping them from communicating the secrets they know. It
        is not clear you can even confine people, short of killing them, in the
        most repressive of societies. To keep secrets, you must trust the people
        who know the secret.
      <p>The last tool we have is trust. However, in general we want to follow
        the dictum of, "Trust, but verify." For people we use techniques such
        as non-disclosure agreements, background checks, and audit trails. For
        programs we perform security audits. Since auditing every program we run
        is unfeasible, so we really want to limit the number of programs we need
        to audit.
      <p>Here are the techniques we have related to the actor and the property
        we are concerned with:
      <table border="1" cellpadding="12" align="center">
        <tr>
          <th>&nbsp;</th>
          <th>Secrecy</th>
          <th>Modification</th>
          <th>Misuse</th>
        </tr>
        <tr>
          <th>Programs</th>
          <td>trust, no-access</td>
          <td>trust, no-access, r/o-access</td>
          <td>confinement</td>
        </tr>
        <tr>
          <th>People</th>
          <td>trust, no-access</td>
          <td>trust, no-access, r/o-access </td>
          <td>&nbsp;</td>
        </tr>
      </table>
      <div align="center"></div>
      <p>&nbsp;
      <p>An additional set of problems occur when programs have authority which
        their users do not have. The common technique for protecting the integrity
        of databases produces this situation. Users have authority to invoke certain
        database transactions which ensure the rules are followed. The transactions
        in turn have the authority to read and write the database. The kludges
        systems implement to support this requirement are responsible for what
        Norm Hardy calls the <a href="http://www.cis.upenn.edu/%7EKeyKOS/ConfusedDeputy.html">Confused
        Deputy Problem</a>. The program instance has the authority, but it doesn't
        know whether it is from the user or associated with the program. As a
        result, the user can persuade the program to misuse its authority. 
      <p>A solution to the problem of programs running with all the user's authority
        is to create a new security domain for the program instance, and give
        it only the authority it needs to do its job. Consider how we would do
        this in an ACL system. Assume Alice is executing program Foo. We need
        to create a new security domain, lets call it Alice'sFooInstance. We need
        to add Alice'sFooInstance to the ACLs for all the resources that the program
        needs during its execution. This solution lets us enforce the principle
        of least privilege, but still leaves us exposed to the Confused Deputy
        Problem.
      <p>To also solve the Confused Deputy Problem, we need to create three security
        domains. We create Alice'sInstance and add it to the ACLs of objects Alice
        is authorizing, after checking that Alice is on those ACLs. We create
        Foo'sInstance and add it to the ACLs of the objects Foo is authorizing,
        after checking that Foo is on those ACLs. We then create Alice'sFooInstance
        and put it on the ACL for Alice'sInstance and Foo'sInstance. Since it
        must go indirectly thru either Alice'sInstance or Foo'sInstance to access
        objects, it can ensure that it is invoking the correct authority for each
        access.
      <p>These solutions produce many security domains and have significant performance
        problems, even on one computer. When we contemplate them in a distributed,
        mutually suspicious system like the Internet, the performance problems
        get worse, and we introduce distributed authority issues inherent in changing
        ACLs. Capabilities allow us to solve both these problems.
      <p>One view of capabilities is as distributed ACLs. Instead of keeping the
        ACL next to the object it is protecting, we can distribute the entries,
        and authenticate them by a digital signature. A capability can be implemented
        as an object pointer signed by the authority which grants access to that
        object. Since the Internet is inherently insecure, this implementation
        would fall to the first packet sniffer. In SPKI, we protect our capabilities
        (called certs) by including information which can authenticate the holder.
        To allow the holder to create new, restricted security domains, we allow
        delegation.
      <p>With capabilities, we create a new security domain, and give it the capabilities
        Alice is authorizing by getting them from Alice. We also give the capabilities
        Foo is authorizing by getting them from Foo. Since the capabilities combine
        naming with authorization we avoid the Confused Deputy Problem. Since
        the capabilities include the authority, we don't have to update ACLs.
      <p>In a distributed SPKI system, Alice would generate delegation certs to
        whatever machine/security domain was going to run Foo using that machine's
        public key. If Foo was to run on a "random" machine in the network, the
        provider of the Foo program would also generate delegation certs for the
        necessary authority for that machine. Then that machine would have the
        authority to do its job.
      <p>Capability systems can also provide confinement, but the details are
        beyond the scope of this rant. For further information, see the <a href="http://www.cis.upenn.edu/%7EKeyKOS/">KeyKOS
        Page</a> for information on a capability system which did provide confinement.
      <p>While ACL systems like NT may be "the state of the art", we can do significantly
        better.
      <!-- #EndEditable --></TD>
    <TD WIDTH="10%" rowspan="2" align="right" valign="bottom"> </TD>
  </TR>
  <TR VALIGN="TOP"> 
    <TD WIDTH="10%">&nbsp;</TD>
    <TD> <hr>
      Unless stated otherwise, all text on this page which is either unattributed 
      or by Mark S. Miller is hereby placed in the public domain. 
        <div align="center"> 
        <table width="100%" cellpadding="4" cellspacing="0">
          <tr> 
            <td> <table align="left" cellpadding="2">
                <tr> 
                  <td valign="top" align="left" colspan="3"><a href="../../index.html"><img src="../../images/e-lambda.gif" width="32" height="32" border="0" alt="ERights Home"></a> 
                    <!-- #BeginEditable "Path2" -->/&nbsp;<a href="../index.html">elib</a>&nbsp;/&nbsp;<a href="index.html">capability</a>&nbsp;<!-- #EndEditable --></td>
                </tr>
                <tr> 
                  <td valign="top" align="right"><!-- #BeginEditable "PrevButton2" --><a href="overview.html" title="Back to: Overview: Capability Computation"><img src="../../images/prev.gif" width="64" height="32" alt="Back to: Overview: Capability Computation" border="0"></a><!-- #EndEditable --></td>
                  <td valign="bottom" align="left"><!-- #BeginEditable "FirstButton2" --><!-- #EndEditable --></td>
                  <td valign="top" align="left"><!-- #BeginEditable "NextButton2" --><a href="ode/index.html" title="On to: An Ode to the Granovetter Diagram"><img src="../../images/next.gif" width="64" height="32" alt="On to: An Ode to the Granovetter Diagram" border="0"></a><!-- #EndEditable --></td>
                </tr>
              </table></td>
            <td> <table border="3" align="center" cellpadding="6" cellspacing="3">
                <tr> 
                  <td> <div align="center"><font size="-1"><a href="../index.html">ELib</a> 
                      &nbsp;&nbsp; <a href="../../elang/index.html">E Language</a> 
                      &nbsp;&nbsp; <a href="../../smart-contracts/index.html">Smart 
                      Contracts</a> &nbsp;&nbsp; <a href="../../related.html">Related</a> 
                      </font></div></td>
                </tr>
                <tr> 
                  <td> <div align="center"><font size="-1"><a href="../../download/index.html">Download</a> 
                      &nbsp;&nbsp; <a href="http://mumble.net/e/faq.html">FAQ</a> 
                      &nbsp;&nbsp; <a href="../../javadoc/index.html">API</a> &nbsp;&nbsp; 
                      <a href="http://www.eros-os.org/pipermail/e-lang/">Mail 
                      Archive</a> &nbsp;&nbsp; <a href="../../donate.html">Donate</a></font></div></td>
                </tr>
              </table></td>
            <td><div align="right"> 
                <p><a href="https://sourceforge.net/tracker/?func=add&amp;group_id=75274&amp;atid=551529"><i>report 
                  bug</i></a> (including <a href="http://validator.w3.org/check/referer">invalid 
                  html</a>) </p>
                <p><a href="http://www.epic.org/crypto/"><img src="../../images/key.gif" width="37" height="19" alt="Golden Key Campaign" border="0"></a>&nbsp;<a href="http://www.eff.org/br/"><img src="../../images/ribbon.gif" width="18" height="30"
alt="Blue Ribbon Campaign" border="0"></a></div></td>
          </tr>
          
        </table>
      </div></TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate --></HTML>
